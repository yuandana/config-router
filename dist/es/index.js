import{useLocation as r,useParams as t,Redirect as e,BrowserRouter as n,Route as o,Switch as c,NavLink as a,Link as u}from"react-router-dom";export*from"react-router-dom";import i,{createRef as f,useCallback as l}from"react";import{isObject as p,omit as s,isString as y,isFunction as b}from"lodash-es";import{pathToRegexp as O,match as v}from"path-to-regexp";function m(r){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function g(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function h(r,t){return function(r){if(Array.isArray(r))return r}(r)||function(r,t){var e=r&&("undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"]);if(null!=e){var n,o,c=[],a=!0,u=!1;try{for(e=e.call(r);!(a=(n=e.next()).done)&&(c.push(n.value),!t||c.length!==t);a=!0);}catch(r){u=!0,o=r}finally{try{a||null==e.return||e.return()}finally{if(u)throw o}}return c}}(r,t)||function(r,t){if(r){if("string"==typeof r)return g(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?g(r,t):void 0}}(r,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var j=function(r){if(!r)return"";if(!p(r))return"";var t=Object.entries(r).map((function(r){var t=h(r,2),e=t[0],n=t[1];return"".concat(e,"=").concat(n)}));return t.length>0?"?".concat(t.join("&")):""},d=function(r,t){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!r)return"";if(!t||!p(t))return r;var n=r,o=[];if(Object.entries(t).forEach((function(r){var t=h(r,2),e=t[0],c=t[1],a=":".concat(e);-1!==n.indexOf(a)&&(n=n.replace(":".concat(e),c),o.push(e))})),!0===e){var c=s(t,o),a=j(c);n="".concat(n).concat(a)}return n};function P(r,t,e){return t in r?Object.defineProperty(r,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[t]=e,r}var w=f(),E=f(),S=f();function D(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),e.push.apply(e,n)}return e}function k(r){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?D(Object(e),!0).forEach((function(t){P(r,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):D(Object(e)).forEach((function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))}))}return r}var A=function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(!Array.isArray(t))return t;var n=t.map((function(t){var n,o=t.routes,c=t.path,a=t.name;if(!c)throw new Error("@yuandana/config-router: path attribute required");var u,i="".concat(e).concat(c).replace(/\/\/*/g,"/"),f=O(i),l=r(o,i),p=k(k({},t),{},{fullPath:i,regexp:f,routes:l});a&&(E.current||(E.current=new Map),null===(u=E.current)||void 0===u||u.set(a,p));return S.current||(S.current=[]),null===(n=S.current)||void 0===n||n.push(p),p}));return n};function x(r,t){if(null==r)return{};var e,n,o=function(r,t){if(null==r)return{};var e,n,o={},c=Object.keys(r);for(n=0;n<c.length;n++)e=c[n],t.indexOf(e)>=0||(o[e]=r[e]);return o}(r,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(r);for(n=0;n<c.length;n++)e=c[n],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(r,e)&&(o[e]=r[e])}return o}function I(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),e.push.apply(e,n)}return e}function T(r){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?I(Object(e),!0).forEach((function(t){P(r,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):I(Object(e)).forEach((function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))}))}return r}var C=function(r){var t=r.name,e=r.to,n=r.params,o=x(r,["name","to","params"]),c=E.current;if(!t||!c)return T(T({},o),{},{to:e});var a=e,u=(c.get(t)||{}).fullPath,i=d(u,n,!0);return e&&!y(e)||(a=i),p(e)&&(a=T(T({},e),{},{pathname:i})),b(e)&&(a=function(r){var t=T(T({},r),{},{pathname:i});return e(t)}),!a&&t&&(a="".concat(t)),T(T({},o),{},{to:a})},$=function(n){var o=n.route,c=void 0===o?{}:o,a=n.children,u=c.redirect,f=c.component,l=c.fullPath,p=r().pathname,s=t(),y=d(l,s),b=u,O=E.current.get(u);return O&&(b=O.fullPath),(b=d(b,s))&&p===y&&p!==b?i.createElement(e,{from:l,to:b}):function(r){return!!(r&&(r.prototype&&r.prototype.isReactComponent||"object"===m(r)&&r.$$typeof||"function"==typeof r))}(f)?i.createElement(c.component,null,a):a},B=function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!Array.isArray(t))return null;if(0===t.length)return null;var e=t.map((function(t,e){var n=t.routes,c=void 0===n?[]:n,a=t.fullPath,u=r(c),f=0===c.length;return i.createElement(o,{key:a||e,path:a,exact:f,strict:!0},i.createElement($,{route:t},u))}));return i.createElement(c,null,e)},F=function(r){var t=r.routes,e=A(void 0===t?[]:t),o=B(e);return i.createElement(n,{ref:w},o)};function L(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),e.push.apply(e,n)}return e}function M(r){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?L(Object(e),!0).forEach((function(t){P(r,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):L(Object(e)).forEach((function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))}))}return r}var R=function(r){var e=t(),n=r.params,o=M(M({},x(r,["params"])),{},{params:M(M({},e),n)});return o=C(o),i.createElement(a,o)};function U(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),e.push.apply(e,n)}return e}function Y(r){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?U(Object(e),!0).forEach((function(t){P(r,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):U(Object(e)).forEach((function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))}))}return r}var q=function(r){var e=t(),n=r.params,o=Y(Y({},x(r,["params"])),{},{params:Y(Y({},e),n)});return o=C(o),i.createElement(u,o)};function N(r,t){var e=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),e.push.apply(e,n)}return e}function z(r){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?N(Object(e),!0).forEach((function(t){P(r,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)):N(Object(e)).forEach((function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))}))}return r}var G=function(){var r=t();return{navigateBack:l((function(){var r,t;null==w||null===(r=w.current)||void 0===r||null===(t=r.history)||void 0===t||t.goBack()}),[]),navigateTo:l((function(t,e){var n,o,c=(E.current.get(t)||{}).fullPath,a=d(c||t,z(z({},r),e),!0);if(!t)throw new Error("@yuandana/config-router: You must specify a path to navigateTo function");a&&(null==w||null===(n=w.current)||void 0===n||null===(o=n.history)||void 0===o||o.push(a))}),[]),redirectTo:l((function(t,e){var n,o,c=(E.current.get(t)||{}).fullPath,a=d(c||t,z(z({},r),e),!0);if(!t)throw new Error("@yuandana/config-router: You must specify a path to navigateTo function");a&&(null==w||null===(n=w.current)||void 0===n||null===(o=n.history)||void 0===o||o.replace(a))}),[r])}},H=function(){var t=r().search.replace("?","").split("&").map((function(r){var t=h(r.split("="),2),e=t[0],n=t[1];return n==="".concat(parseFloat(n))?[e,parseFloat(n)]:[e,n]}));return Object.fromEntries(t)},J=function(t){var e=r().pathname;if(t){var n,o=null===(n=E.current)||void 0===n?void 0:n.get(t);if(o)return o}var c=function(r){var t;return null===(t=S.current)||void 0===t?void 0:t.find((function(t){var e=t.fullPath;return v(e,{decode:decodeURIComponent})(r)}))}(t||e);if(c)return c};export{F as ConfigRouter,q as Link,R as NavLink,S as flatRoutesRef,E as nameMapperRef,w as navigationRef,G as useNavigate,J as useRoute,H as useSearch};
